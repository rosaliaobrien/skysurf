; Function to get the solar spectrum estimate for any HST filter.
; The input parameter is "wl" or the filter pivot wavelength. This must match
; the wavelength defined in get_zmod.pro
; 
; The solar spectrum values were estimated using Meftah+2018 solar irradiance spectrum and finding the 
; irradiance that HST would measure for each filter, using synphot in Python.
; Meftah+2018: https://www.aanda.org/articles/aa/full_html/2018/03/aa31316-17/aa31316-17.html
; 
; Author: Rosalia O'Brien
; 
function solar_sp, wl

flux_list = [342116.01092185226, 3303413.8230211968, 16446170.76831905, 38540384.25308177, 76676420.67245902, 128397575.82048588, 163383841.02144498, 188032128.2839162, 209709058.79870653, 222817547.04015842, 231397146.5020066, 236879895.06999975, 240377633.42061776, 240102828.21749556, 240207441.71584302, 242311737.400332, 242466975.45810118, 239266492.1652165, 236012167.31356388, 234112458.3463153, 232315803.03923738, 230486116.59469134, 228286915.55386606, 226470781.5675577, 223402900.34007382, 219638777.2725546, 216293016.7440792, 211500303.47740474, 206744275.87123755, 202388213.20880648, 194714148.80128816, 186491553.63645998, 177695555.54650787, 169120143.4729226, 163038749.8826924, 157660709.24363747, 152858997.50144997, 147567784.00121564, 141494800.9698657, 135587161.29024366, 130968090.05460267, 126572711.4813484, 121667103.66006078, 117232006.96815938, 113448941.49968067, 109595246.1106673, 105537099.95096199, 103058055.50303835, 99379501.93762545, 96338608.89280608, 93978899.84951772, 91222947.61009558, 88494034.69464864, 85855255.29991786, 83237630.65178712, 80917313.50268097, 78438109.93458664, 76117181.55382372, 74046645.75447144, 71958356.82435888, 70000915.22051653, 67960181.97848928, 65991330.90663976, 64262513.86657177, 62599709.059710115, 61039646.51628048, 59535442.99040781, 57995180.64472865, 56538132.5450691, 54990222.928732604, 53279644.45365265, 51993377.04684624, 51031913.94275863, 49913322.053653, 48775552.520917535, 47584260.20074189, 46383888.86630086, 45302398.118123665, 44374444.84588014, 43480870.197572455, 42490931.52814285, 41500955.54348326, 40234353.02419229, 38724737.066997886, 37359951.193162344, 36334960.86158876, 35511400.330898605, 34751678.18804755, 34121176.04899815, 33525768.40115048, 33015642.888192605, 32516552.75856839, 31972881.618588552, 31435922.631614495]
wave_list = [0.2, 0.25, 0.3, 0.35, 0.39999999999999997, 0.44999999999999996, 0.49999999999999994, 0.5499999999999999, 0.5999999999999999, 0.6499999999999999, 0.7, 0.7499999999999998, 0.7999999999999998, 0.8499999999999999, 0.8999999999999999, 0.9499999999999997, 0.9999999999999998, 1.0499999999999998, 1.0999999999999999, 1.1499999999999997, 1.1999999999999997, 1.2499999999999998, 1.2999999999999996, 1.3499999999999996, 1.3999999999999997, 1.4499999999999997, 1.4999999999999998, 1.5499999999999996, 1.5999999999999996, 1.6499999999999997, 1.6999999999999995, 1.7499999999999996, 1.7999999999999996, 1.8499999999999996, 1.8999999999999997, 1.9499999999999995, 1.9999999999999996, 2.05, 2.0999999999999996, 2.1499999999999995, 2.1999999999999997, 2.2499999999999996, 2.3, 2.3499999999999996, 2.3999999999999995, 2.4499999999999997, 2.4999999999999996, 2.55, 2.5999999999999996, 2.6499999999999995, 2.6999999999999997, 2.7499999999999996, 2.8, 2.8499999999999996, 2.8999999999999995, 2.9499999999999997, 2.9999999999999996, 3.0499999999999994, 3.0999999999999996, 3.1499999999999995, 3.1999999999999993, 3.2499999999999996, 3.2999999999999994, 3.3499999999999996, 3.3999999999999995, 3.4499999999999993, 3.4999999999999996, 3.5499999999999994, 3.5999999999999996, 3.6499999999999995, 3.6999999999999993, 3.7499999999999996, 3.7999999999999994, 3.849999999999999, 3.8999999999999995, 3.9499999999999993, 3.999999999999999, 4.049999999999999, 4.099999999999999, 4.1499999999999995, 4.199999999999999, 4.249999999999999, 4.299999999999999, 4.35, 4.3999999999999995, 4.449999999999999, 4.499999999999999, 4.549999999999999, 4.599999999999999, 4.6499999999999995, 4.699999999999999, 4.749999999999999, 4.799999999999999, 4.849999999999999]
  
  ; Find closest wavelength
  diff_arr = abs(wave_list - wl)
  mn = (min(diff_arr, minval))
  idx = array_indices(diff_arr, minval)

  return, flux_list[idx]

end