"""
Solar Spectrum Function for HST Filters

Function to get the solar spectrum estimate for any HST filter.
The solar spectrum values were estimated using Meftah+2018 solar irradiance spectrum 
and finding the irradiance that HST would measure for each filter, using synphot in Python.

Meftah+2018: https://www.aanda.org/articles/aa/full_html/2018/03/aa31316-17/aa31316-17.html

Author: Rosalia O'Brien
Python conversion: Tejovrash Acharya
"""

import numpy as np

def solar_sp(wl):
    """
    Get solar spectrum estimate for any HST filter wavelength.
    
    Parameters:
    -----------
    wl : float
        Filter pivot wavelength in microns
        
    Returns:
    --------
    float
        Solar irradiance flux corresponding to the wavelength
    """
    
    # Solar spectrum flux values from Meftah+2018 processed through synphot
    flux_list = np.array([
        342116.01092185226, 3303413.8230211968, 16446170.76831905, 38540384.25308177,
        76676420.67245902, 128397575.82048588, 163383841.02144498, 188032128.2839162,
        209709058.79870653, 222817547.04015842, 231397146.5020066, 236879895.06999975,
        240377633.42061776, 240102828.21749556, 240207441.71584302, 242311737.400332,
        242466975.45810118, 239266492.1652165, 236012167.31356388, 234112458.3463153,
        232315803.03923738, 230486116.59469134, 228286915.55386606, 226470781.5675577,
        223402900.34007382, 219638777.2725546, 216293016.7440792, 211500303.47740474,
        206744275.87123755, 202388213.20880648, 194714148.80128816, 186491553.63645998,
        177695555.54650787, 169120143.4729226, 163038749.8826924, 157660709.24363747,
        152858997.50144997, 147567784.00121564, 141494800.9698657, 135587161.29024366,
        130968090.05460267, 126572711.4813484, 121667103.66006078, 117232006.96815938,
        113448941.49968067, 109595246.1106673, 105537099.95096199, 103058055.50303835,
        99379501.93762545, 96338608.89280608, 93978899.84951772, 91222947.61009558,
        88494034.69464864, 85855255.29991786, 83237630.65178712, 80917313.50268097,
        78438109.93458664, 76117181.55382372, 74046645.75447144, 71958356.82435888,
        70000915.22051653, 67960181.97848928, 65991330.90663976, 64262513.86657177,
        62599709.059710115, 61039646.51628048, 59535442.99040781, 57995180.64472865,
        56538132.5450691, 54990222.928732604, 53279644.45365265, 51993377.04684624,
        51031913.94275863, 49913322.053653, 48775552.520917535, 47584260.20074189,
        46383888.86630086, 45302398.118123665, 44374444.84588014, 43480870.197572455,
        42490931.52814285, 41500955.54348326, 40234353.02419229, 38724737.066997886,
        37359951.193162344, 36334960.86158876, 35511400.330898605, 34751678.18804755,
        34121176.04899815, 33525768.40115048, 33015642.888192605, 32516552.75856839,
        31972881.618588552, 31435922.631614495
    ])
    
    # Corresponding wavelengths in microns
    wave_list = np.array([
        0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85,
        0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55,
        1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25,
        2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95,
        3.0, 3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65,
        3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4.0, 4.05, 4.1, 4.15, 4.2, 4.25, 4.3, 4.35,
        4.4, 4.45, 4.5, 4.55, 4.6, 4.65, 4.7, 4.75, 4.8, 4.85
    ])
    
    # Find closest wavelength
    diff_arr = np.abs(wave_list - wl)
    idx = np.argmin(diff_arr)
    # print(idx)
    return flux_list[idx]